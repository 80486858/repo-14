# sorbet-rails
Set of tools to make sorbet work with rails seamlessly.

This gem adds a few rake tasks to generate RBI for dynamic methods generated by Rails. It also includes sigs for related Rails classes. The generated rbis are added to `sorbet/rails-rbi/` folder.

Please feel free to send PR requests or file issues to improve the functionality of the gem!

## ActiveRecord RBI

There are ActiveRecord RBI that we vendor with this gem. Please run `srb tc sorbet-typed` to include the provided RBI in your `sorbet/rbi_list`

## Routes RBI
The following rake task generates `_path` and `_url` methods for all named routes defined in `routes.rb`
```
  rake rails_rbi:routes
```
## Models RBI
The following rake task generates rbi files for all models in the Rails App (all descendants of ActiveRecord::Base)
```
  rake rails_rbi:models
```
You can also regenerate rbi files for specific models
```
  rake rails_rbi:models[ModelName,AnotherOne,...]
```
At the moment, the generation task generate the following signatures
- Column getters & setters
- Associations getters & setters
- Enum values, checkers & scopes
- Named scopes
- Model relation class

## Special cases 
### `find`, `first` and `last` 
These 3 methods can either return a single nilable record or an array of records. Sorbet does not allow us to define multiple sigs for a function. It doesn't support defining one function sig that has varying returning value depending on the input param type. We opt to define the most commonly used sig for these methods, and monkey-patch new functions for the secondary use.

In short:
- Use `find`, `first` and `last` to fetch a single record
- Use `find_n`, `first_n`, `last_n` to fetch an array of records.


